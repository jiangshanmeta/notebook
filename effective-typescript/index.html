<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>Effective TypeScript | notebook</title>
    <meta name="generator" content="VuePress 1.5.2">
    <link rel="icon" href="/notebook/favicon.ico">
    <meta name="description" content="">
    <link rel="preload" href="/notebook/assets/css/0.styles.5dd3b3b5.css" as="style"><link rel="preload" href="/notebook/assets/js/app.88dbcdf2.js" as="script"><link rel="preload" href="/notebook/assets/js/2.afe3d9dc.js" as="script"><link rel="preload" href="/notebook/assets/js/46.b3c5cf46.js" as="script"><link rel="prefetch" href="/notebook/assets/js/10.30f04687.js"><link rel="prefetch" href="/notebook/assets/js/100.57bb333c.js"><link rel="prefetch" href="/notebook/assets/js/101.45d6b95d.js"><link rel="prefetch" href="/notebook/assets/js/102.8b5867b5.js"><link rel="prefetch" href="/notebook/assets/js/103.a397dad0.js"><link rel="prefetch" href="/notebook/assets/js/104.93c9883e.js"><link rel="prefetch" href="/notebook/assets/js/105.25dd3ed2.js"><link rel="prefetch" href="/notebook/assets/js/106.95c2ba6d.js"><link rel="prefetch" href="/notebook/assets/js/107.87a3b503.js"><link rel="prefetch" href="/notebook/assets/js/108.f0c4393e.js"><link rel="prefetch" href="/notebook/assets/js/109.8bf05bfe.js"><link rel="prefetch" href="/notebook/assets/js/11.67818eea.js"><link rel="prefetch" href="/notebook/assets/js/110.b082f582.js"><link rel="prefetch" href="/notebook/assets/js/111.3ee24011.js"><link rel="prefetch" href="/notebook/assets/js/112.f7cfdd51.js"><link rel="prefetch" href="/notebook/assets/js/113.13e42c26.js"><link rel="prefetch" href="/notebook/assets/js/114.ade508e9.js"><link rel="prefetch" href="/notebook/assets/js/115.0572beb9.js"><link rel="prefetch" href="/notebook/assets/js/116.cd1a0b66.js"><link rel="prefetch" href="/notebook/assets/js/117.cfa7eb36.js"><link rel="prefetch" href="/notebook/assets/js/118.686e6f15.js"><link rel="prefetch" href="/notebook/assets/js/119.efb31fc6.js"><link rel="prefetch" href="/notebook/assets/js/12.79c4791c.js"><link rel="prefetch" href="/notebook/assets/js/120.bd9d55f3.js"><link rel="prefetch" href="/notebook/assets/js/121.ad5a89c3.js"><link rel="prefetch" href="/notebook/assets/js/122.5ff0650a.js"><link rel="prefetch" href="/notebook/assets/js/123.99c07444.js"><link rel="prefetch" href="/notebook/assets/js/124.9dfba2ea.js"><link rel="prefetch" href="/notebook/assets/js/125.40f1698a.js"><link rel="prefetch" href="/notebook/assets/js/126.66845011.js"><link rel="prefetch" href="/notebook/assets/js/127.90e31dfb.js"><link rel="prefetch" href="/notebook/assets/js/128.29c33433.js"><link rel="prefetch" href="/notebook/assets/js/129.51bbe559.js"><link rel="prefetch" href="/notebook/assets/js/13.390cb3ce.js"><link rel="prefetch" href="/notebook/assets/js/130.b5c14733.js"><link rel="prefetch" href="/notebook/assets/js/131.70ddd71a.js"><link rel="prefetch" href="/notebook/assets/js/132.419dc91b.js"><link rel="prefetch" href="/notebook/assets/js/133.11046762.js"><link rel="prefetch" href="/notebook/assets/js/134.079cce74.js"><link rel="prefetch" href="/notebook/assets/js/135.02b82d70.js"><link rel="prefetch" href="/notebook/assets/js/136.1f262c0c.js"><link rel="prefetch" href="/notebook/assets/js/137.8c12a024.js"><link rel="prefetch" href="/notebook/assets/js/138.7cb18cb4.js"><link rel="prefetch" href="/notebook/assets/js/139.683c5351.js"><link rel="prefetch" href="/notebook/assets/js/14.f50b0925.js"><link rel="prefetch" href="/notebook/assets/js/140.20f0ebb1.js"><link rel="prefetch" href="/notebook/assets/js/141.8497489d.js"><link rel="prefetch" href="/notebook/assets/js/142.c547fc48.js"><link rel="prefetch" href="/notebook/assets/js/143.450866de.js"><link rel="prefetch" href="/notebook/assets/js/144.936e0f80.js"><link rel="prefetch" href="/notebook/assets/js/145.003cbc51.js"><link rel="prefetch" href="/notebook/assets/js/146.59c0e68c.js"><link rel="prefetch" href="/notebook/assets/js/147.67802b4a.js"><link rel="prefetch" href="/notebook/assets/js/148.990e2766.js"><link rel="prefetch" href="/notebook/assets/js/149.3119c2f0.js"><link rel="prefetch" href="/notebook/assets/js/15.fe1e2609.js"><link rel="prefetch" href="/notebook/assets/js/150.b3ade954.js"><link rel="prefetch" href="/notebook/assets/js/151.d714a6d6.js"><link rel="prefetch" href="/notebook/assets/js/152.e540f97a.js"><link rel="prefetch" href="/notebook/assets/js/153.59dc49fd.js"><link rel="prefetch" href="/notebook/assets/js/154.404b67a8.js"><link rel="prefetch" href="/notebook/assets/js/16.5d5a70d1.js"><link rel="prefetch" href="/notebook/assets/js/17.8e858e9e.js"><link rel="prefetch" href="/notebook/assets/js/18.410e91ec.js"><link rel="prefetch" href="/notebook/assets/js/19.187f3d66.js"><link rel="prefetch" href="/notebook/assets/js/20.a1f0c642.js"><link rel="prefetch" href="/notebook/assets/js/21.dc299b3e.js"><link rel="prefetch" href="/notebook/assets/js/22.1e85aef5.js"><link rel="prefetch" href="/notebook/assets/js/23.a1b0253d.js"><link rel="prefetch" href="/notebook/assets/js/24.6373fb85.js"><link rel="prefetch" href="/notebook/assets/js/25.2ba02428.js"><link rel="prefetch" href="/notebook/assets/js/26.735c9cec.js"><link rel="prefetch" href="/notebook/assets/js/27.1ca51e0a.js"><link rel="prefetch" href="/notebook/assets/js/28.46913a0b.js"><link rel="prefetch" href="/notebook/assets/js/29.2c05f4e8.js"><link rel="prefetch" href="/notebook/assets/js/3.66fe03f4.js"><link rel="prefetch" href="/notebook/assets/js/30.f6a380c1.js"><link rel="prefetch" href="/notebook/assets/js/31.72f604da.js"><link rel="prefetch" href="/notebook/assets/js/32.d0c6e615.js"><link rel="prefetch" href="/notebook/assets/js/33.d9e9736d.js"><link rel="prefetch" href="/notebook/assets/js/34.0b7187d6.js"><link rel="prefetch" href="/notebook/assets/js/35.0d141e21.js"><link rel="prefetch" href="/notebook/assets/js/36.2475a37d.js"><link rel="prefetch" href="/notebook/assets/js/37.aa6d8ade.js"><link rel="prefetch" href="/notebook/assets/js/38.14be3450.js"><link rel="prefetch" href="/notebook/assets/js/39.3a80eca0.js"><link rel="prefetch" href="/notebook/assets/js/4.ab7aafc6.js"><link rel="prefetch" href="/notebook/assets/js/40.fbccbea6.js"><link rel="prefetch" href="/notebook/assets/js/41.79177688.js"><link rel="prefetch" href="/notebook/assets/js/42.932f2d55.js"><link rel="prefetch" href="/notebook/assets/js/43.8049c3b8.js"><link rel="prefetch" href="/notebook/assets/js/44.e4b3bdc8.js"><link rel="prefetch" href="/notebook/assets/js/45.0c3a2c18.js"><link rel="prefetch" href="/notebook/assets/js/47.4ec887fa.js"><link rel="prefetch" href="/notebook/assets/js/48.59d91c81.js"><link rel="prefetch" href="/notebook/assets/js/49.2c51406c.js"><link rel="prefetch" href="/notebook/assets/js/5.ba918a0c.js"><link rel="prefetch" href="/notebook/assets/js/50.ff16ae1e.js"><link rel="prefetch" href="/notebook/assets/js/51.4b677a9a.js"><link rel="prefetch" href="/notebook/assets/js/52.65802033.js"><link rel="prefetch" href="/notebook/assets/js/53.722a075e.js"><link rel="prefetch" href="/notebook/assets/js/54.d57c483d.js"><link rel="prefetch" href="/notebook/assets/js/55.46e1681f.js"><link rel="prefetch" href="/notebook/assets/js/56.0b2f87cf.js"><link rel="prefetch" href="/notebook/assets/js/57.979ab8bb.js"><link rel="prefetch" href="/notebook/assets/js/58.ef4d0527.js"><link rel="prefetch" href="/notebook/assets/js/59.ef8188c1.js"><link rel="prefetch" href="/notebook/assets/js/6.0704a9ed.js"><link rel="prefetch" href="/notebook/assets/js/60.9b12be81.js"><link rel="prefetch" href="/notebook/assets/js/61.5859506f.js"><link rel="prefetch" href="/notebook/assets/js/62.b2bf31d1.js"><link rel="prefetch" href="/notebook/assets/js/63.eb32d77b.js"><link rel="prefetch" href="/notebook/assets/js/64.195aa86b.js"><link rel="prefetch" href="/notebook/assets/js/65.d8f98a35.js"><link rel="prefetch" href="/notebook/assets/js/66.e15d42cb.js"><link rel="prefetch" href="/notebook/assets/js/67.2389c122.js"><link rel="prefetch" href="/notebook/assets/js/68.7fe65f49.js"><link rel="prefetch" href="/notebook/assets/js/69.a6c292ef.js"><link rel="prefetch" href="/notebook/assets/js/7.9b747207.js"><link rel="prefetch" href="/notebook/assets/js/70.d666d768.js"><link rel="prefetch" href="/notebook/assets/js/71.192a6d11.js"><link rel="prefetch" href="/notebook/assets/js/72.09553cee.js"><link rel="prefetch" href="/notebook/assets/js/73.de9333c7.js"><link rel="prefetch" href="/notebook/assets/js/74.d9565dd7.js"><link rel="prefetch" href="/notebook/assets/js/75.48f9954c.js"><link rel="prefetch" href="/notebook/assets/js/76.fe5f3aaf.js"><link rel="prefetch" href="/notebook/assets/js/77.b7ccf26f.js"><link rel="prefetch" href="/notebook/assets/js/78.21b50911.js"><link rel="prefetch" href="/notebook/assets/js/79.79cc5c2f.js"><link rel="prefetch" href="/notebook/assets/js/8.17a8a4c4.js"><link rel="prefetch" href="/notebook/assets/js/80.d7722129.js"><link rel="prefetch" href="/notebook/assets/js/81.49fd387e.js"><link rel="prefetch" href="/notebook/assets/js/82.40a26ec0.js"><link rel="prefetch" href="/notebook/assets/js/83.a4d76c39.js"><link rel="prefetch" href="/notebook/assets/js/84.1fd9f51f.js"><link rel="prefetch" href="/notebook/assets/js/85.1155f6c4.js"><link rel="prefetch" href="/notebook/assets/js/86.805c1200.js"><link rel="prefetch" href="/notebook/assets/js/87.d3132800.js"><link rel="prefetch" href="/notebook/assets/js/88.b2f31a46.js"><link rel="prefetch" href="/notebook/assets/js/89.85db4046.js"><link rel="prefetch" href="/notebook/assets/js/9.a757c988.js"><link rel="prefetch" href="/notebook/assets/js/90.c4d97670.js"><link rel="prefetch" href="/notebook/assets/js/91.f5692cfc.js"><link rel="prefetch" href="/notebook/assets/js/92.b8e5460e.js"><link rel="prefetch" href="/notebook/assets/js/93.91bf9188.js"><link rel="prefetch" href="/notebook/assets/js/94.259a46fe.js"><link rel="prefetch" href="/notebook/assets/js/95.1c83eb81.js"><link rel="prefetch" href="/notebook/assets/js/96.d9a4b728.js"><link rel="prefetch" href="/notebook/assets/js/97.8ec3d232.js"><link rel="prefetch" href="/notebook/assets/js/98.6c2c0a0d.js"><link rel="prefetch" href="/notebook/assets/js/99.b5039817.js">
    <link rel="stylesheet" href="/notebook/assets/css/0.styles.5dd3b3b5.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/notebook/" class="home-link router-link-active"><!----> <span class="site-name">notebook</span></a> <div class="links"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <!----></div></header> <div class="sidebar-mask"></div> <aside class="sidebar"><!---->  <ul class="sidebar-links"><li><a href="/notebook/high-performance-web-site/" class="sidebar-link">高性能网站建设指南</a></li><li><a href="/notebook/illustration-HTTP/" class="sidebar-link">图解HTTP</a></li><li><a href="/notebook/functional-programming-in-javascript/" class="sidebar-link">JavaScript函数式编程指南</a></li><li><a href="/notebook/javascript-framework-design/" class="sidebar-link">JavaScript框架设计</a></li><li><a href="/notebook/front-end-architecture/" class="sidebar-link">前端架构设计</a></li><li><a href="/notebook/web-performance-in-action/" class="sidebar-link">web性能实战</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/notebook/web-performance-in-action/#优化css" class="sidebar-link">优化CSS</a></li><li class="sidebar-sub-header"><a href="/notebook/web-performance-in-action/#优化图片" class="sidebar-link">优化图片</a></li><li class="sidebar-sub-header"><a href="/notebook/web-performance-in-action/#优化字体" class="sidebar-link">优化字体</a></li><li class="sidebar-sub-header"><a href="/notebook/web-performance-in-action/#优化javascript" class="sidebar-link">优化JavaScript</a></li><li class="sidebar-sub-header"><a href="/notebook/web-performance-in-action/#基于service-worker和cacahestorage缓存资源" class="sidebar-link">基于service-worker和cacaheStorage缓存资源</a></li><li class="sidebar-sub-header"><a href="/notebook/web-performance-in-action/#使用资源提示" class="sidebar-link">使用资源提示</a></li><li class="sidebar-sub-header"><a href="/notebook/web-performance-in-action/#http2优化" class="sidebar-link">HTTP2优化</a></li></ul></li><li><a href="/notebook/css-in-depth/" class="sidebar-link">深入解析 CSS</a></li><li><a href="/notebook/web-security/" class="sidebar-link">白帽子讲Web安全</a></li><li><a href="/notebook/effective-typescript/" aria-current="page" class="active sidebar-link">Effective TypeScript</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/notebook/effective-typescript/#getting-to-know-typescript" class="sidebar-link">Getting to Know TypeScript</a></li><li class="sidebar-sub-header"><a href="/notebook/effective-typescript/#typescript-t-type-system" class="sidebar-link">TypeScript't Type System</a></li><li class="sidebar-sub-header"><a href="/notebook/effective-typescript/#type-inference" class="sidebar-link">Type Inference</a></li><li class="sidebar-sub-header"><a href="/notebook/effective-typescript/#type-design" class="sidebar-link">Type Design</a></li><li class="sidebar-sub-header"><a href="/notebook/effective-typescript/#working-with-any" class="sidebar-link">Working with any</a></li><li class="sidebar-sub-header"><a href="/notebook/effective-typescript/#types-declarations-and-types" class="sidebar-link">Types Declarations and @types</a></li><li class="sidebar-sub-header"><a href="/notebook/effective-typescript/#writing-and-running-your-code" class="sidebar-link">Writing and Running Your Code</a></li><li class="sidebar-sub-header"><a href="/notebook/effective-typescript/#migrating-to-typescript" class="sidebar-link">Migrating to TypeScript</a></li></ul></li><li><a href="/notebook/nodejs-in-practice/" class="sidebar-link">Node.js硬实战：115个核心技巧</a></li><li><a href="/notebook/mastering-modular-javascript/" class="sidebar-link">精通模块化JavaScript</a></li><li><a href="/notebook/svg-essentials/" class="sidebar-link">SVG精髓</a></li><li><a href="/notebook/nodejs-in-depth/" class="sidebar-link">深入浅出Node.js</a></li><li><a href="/notebook/interesting-algorithm-puzzles-for-programmers/" class="sidebar-link">程序员的算法趣题</a></li><li><a href="/notebook/java-by-comparison/" class="sidebar-link">Java By Comparison</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/notebook/java-by-comparison/#start-cleaning-up" class="sidebar-link">Start Cleaning Up</a></li><li class="sidebar-sub-header"><a href="/notebook/java-by-comparison/#level-up-your-code-style" class="sidebar-link">Level Up Your Code Style</a></li><li class="sidebar-sub-header"><a href="/notebook/java-by-comparison/#use-comments-wisely" class="sidebar-link">Use Comments Wisely</a></li><li class="sidebar-sub-header"><a href="/notebook/java-by-comparison/#name-things-right" class="sidebar-link">Name Things Right</a></li><li class="sidebar-sub-header"><a href="/notebook/java-by-comparison/#prepare-for-things-going-wrong" class="sidebar-link">Prepare for Things Going Wrong</a></li><li class="sidebar-sub-header"><a href="/notebook/java-by-comparison/#assert-things-going-right" class="sidebar-link">Assert Things Going Right</a></li><li class="sidebar-sub-header"><a href="/notebook/java-by-comparison/#design-your-objects" class="sidebar-link">Design Your Objects</a></li><li class="sidebar-sub-header"><a href="/notebook/java-by-comparison/#let-your-data-flow" class="sidebar-link">Let Your Data Flow</a></li><li class="sidebar-sub-header"><a href="/notebook/java-by-comparison/#prepare-for-the-real-world" class="sidebar-link">Prepare for the Real World</a></li></ul></li><li><a href="/notebook/solidbook/" class="sidebar-link">Solid Book</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/notebook/solidbook/#complexity" class="sidebar-link">Complexity</a></li></ul></li><li><a href="/notebook/unit-testing/" class="sidebar-link">Unit Testing</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/notebook/unit-testing/#the-goal-of-unit-testing" class="sidebar-link">The goal of unit testing</a></li><li class="sidebar-sub-header"><a href="/notebook/unit-testing/#what-is-a-unit-test" class="sidebar-link">What is a unit test</a></li><li class="sidebar-sub-header"><a href="/notebook/unit-testing/#the-anatomy-of-a-unit-test" class="sidebar-link">The anatomy of a unit test</a></li><li class="sidebar-sub-header"><a href="/notebook/unit-testing/#the-four-pillars-of-a-good-unit-test" class="sidebar-link">The four pillars of a good unit test</a></li><li class="sidebar-sub-header"><a href="/notebook/unit-testing/#mocks-and-test-fragility" class="sidebar-link">Mocks and test fragility</a></li><li class="sidebar-sub-header"><a href="/notebook/unit-testing/#styles-of-unit-testing" class="sidebar-link">Styles of unit testing</a></li><li class="sidebar-sub-header"><a href="/notebook/unit-testing/#refactoring-toward-valuable-unit-tests" class="sidebar-link">Refactoring toward valuable unit tests</a></li><li class="sidebar-sub-header"><a href="/notebook/unit-testing/#why-integration-testing" class="sidebar-link">Why integration testing</a></li><li class="sidebar-sub-header"><a href="/notebook/unit-testing/#mocking-best-practices" class="sidebar-link">Mocking best practices</a></li><li class="sidebar-sub-header"><a href="/notebook/unit-testing/#unit-testing-anti-patterns" class="sidebar-link">Unit testing anti-patterns</a></li></ul></li><li><a href="/notebook/the-art-of-unit-testing/" class="sidebar-link">The Art of Unit Testing</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/notebook/the-art-of-unit-testing/#the-basics-of-unit-testing" class="sidebar-link">The basics of unit testing</a></li><li class="sidebar-sub-header"><a href="/notebook/the-art-of-unit-testing/#a-first-unit-test" class="sidebar-link">A first unit test</a></li><li class="sidebar-sub-header"><a href="/notebook/the-art-of-unit-testing/#breaking-dependencies-with-stub" class="sidebar-link">Breaking dependencies with stub</a></li><li class="sidebar-sub-header"><a href="/notebook/the-art-of-unit-testing/#interaction-testing-using-mock-objects" class="sidebar-link">Interaction testing using mock objects</a></li><li class="sidebar-sub-header"><a href="/notebook/the-art-of-unit-testing/#isolation-frameworks" class="sidebar-link">Isolation frameworks</a></li><li class="sidebar-sub-header"><a href="/notebook/the-art-of-unit-testing/#unit-testing-asynchronous-code" class="sidebar-link">Unit testing asynchronous code</a></li><li class="sidebar-sub-header"><a href="/notebook/the-art-of-unit-testing/#trustworthy-tests" class="sidebar-link">Trustworthy tests</a></li><li class="sidebar-sub-header"><a href="/notebook/the-art-of-unit-testing/#maintainability" class="sidebar-link">Maintainability</a></li><li class="sidebar-sub-header"><a href="/notebook/the-art-of-unit-testing/#readability" class="sidebar-link">Readability</a></li><li class="sidebar-sub-header"><a href="/notebook/the-art-of-unit-testing/#developing-a-testing-strategy" class="sidebar-link">Developing a testing strategy</a></li><li class="sidebar-sub-header"><a href="/notebook/the-art-of-unit-testing/#monkey-patching-functions-and-modules" class="sidebar-link">Monkey-patching functions and modules</a></li></ul></li><li><a href="/notebook/modern-java-recipe/" class="sidebar-link">Modern Java Recipes</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/notebook/modern-java-recipe/#the-basics" class="sidebar-link">The Basics</a></li><li class="sidebar-sub-header"><a href="/notebook/modern-java-recipe/#the-java-util-function-package" class="sidebar-link">The java.util.function Package</a></li><li class="sidebar-sub-header"><a href="/notebook/modern-java-recipe/#streams" class="sidebar-link">Streams</a></li><li class="sidebar-sub-header"><a href="/notebook/modern-java-recipe/#comparators-and-collectors" class="sidebar-link">Comparators and Collectors</a></li><li class="sidebar-sub-header"><a href="/notebook/modern-java-recipe/#issues-with-streams-lambdas-and-method-references" class="sidebar-link">Issues with Streams, Lambdas, and Method References</a></li><li class="sidebar-sub-header"><a href="/notebook/modern-java-recipe/#the-optional-type" class="sidebar-link">The Optional Type</a></li><li class="sidebar-sub-header"><a href="/notebook/modern-java-recipe/#file-i-o" class="sidebar-link">File I/O</a></li><li class="sidebar-sub-header"><a href="/notebook/modern-java-recipe/#the-java-time-package" class="sidebar-link">The java.time Package</a></li><li class="sidebar-sub-header"><a href="/notebook/modern-java-recipe/#parallelism-and-concurrency" class="sidebar-link">Parallelism and Concurrency</a></li></ul></li><li><a href="/notebook/fluent-react/" class="sidebar-link">Fluent React</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/notebook/fluent-react/#common-questions-and-powerful-patterns" class="sidebar-link">Common Questions and Powerful Patterns</a></li></ul></li><li><a href="/notebook/advanced-react/" class="sidebar-link">Advanced React</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/notebook/advanced-react/#intro-to-re-renders" class="sidebar-link">Intro-to re-renders</a></li><li class="sidebar-sub-header"><a href="/notebook/advanced-react/#elements-children-as-props-and-re-renders-components-as-props-pattern" class="sidebar-link">Elements, children as props, and re-renders (Components as Props Pattern)</a></li><li class="sidebar-sub-header"><a href="/notebook/advanced-react/#configuration-concerns-with-elements-as-props" class="sidebar-link">Configuration concerns with elements as props</a></li><li class="sidebar-sub-header"><a href="/notebook/advanced-react/#advanced-configuration-with-render-props" class="sidebar-link">Advanced configuration with render props</a></li><li class="sidebar-sub-header"><a href="/notebook/advanced-react/#memorization-with-usememo-usecallback-and-react-memo" class="sidebar-link">Memorization with useMemo useCallback and React.memo</a></li><li class="sidebar-sub-header"><a href="/notebook/advanced-react/#deep-dive-into-diffing-and-reconciliation" class="sidebar-link">Deep dive into diffing and reconciliation</a></li><li class="sidebar-sub-header"><a href="/notebook/advanced-react/#hoc-in-modern-world" class="sidebar-link">HOC in modern world</a></li><li class="sidebar-sub-header"><a href="/notebook/advanced-react/#react-context-and-performance" class="sidebar-link">React Context and Performance</a></li><li class="sidebar-sub-header"><a href="/notebook/advanced-react/#refs-from-storing-data-to-imperative-api" class="sidebar-link">Refs: from storing data to imperative API</a></li><li class="sidebar-sub-header"><a href="/notebook/advanced-react/#closures-in-react" class="sidebar-link">Closures in React</a></li><li class="sidebar-sub-header"><a href="/notebook/advanced-react/#implementing-advanced-debouncing-and-throttling-with-refs" class="sidebar-link">Implementing advanced debouncing and throttling with Refs</a></li><li class="sidebar-sub-header"><a href="/notebook/advanced-react/#escaping-flickering-ui-with-uselayouteffect" class="sidebar-link">Escaping Flickering UI with useLayoutEffect</a></li><li class="sidebar-sub-header"><a href="/notebook/advanced-react/#react-portals-and-why-do-we-need-them" class="sidebar-link">React portals and why do we need them</a></li><li class="sidebar-sub-header"><a href="/notebook/advanced-react/#data-fetching-on-the-client-and-performance" class="sidebar-link">Data fetching on the client and performance</a></li></ul></li></ul> </aside> <main class="page"> <div class="theme-default-content content__default"><h1 id="effective-typescript"><a href="#effective-typescript" class="header-anchor">#</a> <a href="https://book.douban.com/subject/34893998/" target="_blank" rel="noopener noreferrer">Effective TypeScript<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></h1> <h2 id="getting-to-know-typescript"><a href="#getting-to-know-typescript" class="header-anchor">#</a> Getting to Know TypeScript</h2> <h3 id="_1-understand-the-relationship-between-typescript-and-javascript"><a href="#_1-understand-the-relationship-between-typescript-and-javascript" class="header-anchor">#</a> 1. Understand the Relationship Between TypeScript and JavaScript</h3> <ul><li>TypeScript 是 JavaScript 的超集</li> <li>TypeScript添加了一个类型系统，该类型系统可对JavaScript的运行时行为进行建模，并尝试发现运行时引发异常的代码</li></ul> <h3 id="_2-know-which-typescript-options-you-re-using"><a href="#_2-know-which-typescript-options-you-re-using" class="header-anchor">#</a> 2. Know Which TypeScript Options You're Using</h3> <p>TypeScript提供了可以影响语言层面的配置，比如 noImplicitAny strictNullChecks。显然要选择尽可能严格的配置。</p> <h3 id="_3-understand-that-code-generation-is-independent-of-types"><a href="#_3-understand-that-code-generation-is-independent-of-types" class="header-anchor">#</a> 3. Understand That Code Generation Is Independent of Types</h3> <p>代码生成和类型检查是独立的。</p> <ul><li>类型报错也可以生成代码</li> <li>运行时没有TS类型</li> <li>断言类型不影响运行时类型</li> <li>运行时类型和声明的类型可能不一致</li> <li>不支持静态重载，只支持类型签名实现重载</li> <li>TS类型不影响运行时性能</li></ul> <h3 id="_4-get-comfortable-with-structural-typing"><a href="#_4-get-comfortable-with-structural-typing" class="header-anchor">#</a> 4. Get Comfortable with Structural Typing</h3> <ul><li>JS是鸭子类型，TS通过结构化类型对此进行描述。子类型不一定通过extends(继承)实现，只要结构满足依然视为子类型。</li> <li>TypeScript类型不是“密封的”，一个满足特定interface的值可能会有额外的属性，所以遍历对象很难做到类型正确。</li></ul> <h3 id="_5-limit-use-of-the-any-type"><a href="#_5-limit-use-of-the-any-type" class="header-anchor">#</a> 5. Limit Use of the any Type</h3> <h2 id="typescript-t-type-system"><a href="#typescript-t-type-system" class="header-anchor">#</a> TypeScript't Type System</h2> <h3 id="_6-use-your-editor-to-interrogate-and-explore-the-type-system"><a href="#_6-use-your-editor-to-interrogate-and-explore-the-type-system" class="header-anchor">#</a> 6. Use Your Editor to Interrogate and Explore the Type System</h3> <h3 id="_7-think-of-types-as-sets-of-values"><a href="#_7-think-of-types-as-sets-of-values" class="header-anchor">#</a> 7. Think of Types as Sets of Values</h3> <p>把类型当做值的集合思考</p> <div class="language-typescript extra-class"><pre class="language-typescript"><code><span class="token keyword">type</span> <span class="token class-name"><span class="token constant">A</span></span><span class="token operator">=</span> <span class="token string">'A'</span> <span class="token comment">// 单值集合 { 'A' }</span>
<span class="token keyword">type</span> <span class="token class-name"><span class="token constant">B</span></span><span class="token operator">=</span> <span class="token string">'B'</span> <span class="token comment">// 单值集合 { 'B' }</span>
<span class="token keyword">type</span> <span class="token class-name"><span class="token constant">AB</span></span> <span class="token operator">=</span> <span class="token string">'A'</span> <span class="token operator">|</span> <span class="token string">'B'</span>  <span class="token comment">// 集合的并集 { 'A', 'B' }</span>
<span class="token keyword">type</span> <span class="token class-name">twoInt</span> <span class="token operator">=</span>  <span class="token number">2</span> <span class="token operator">|</span> <span class="token number">4</span> <span class="token operator">|</span> <span class="token number">5</span> <span class="token operator">...</span> <span class="token comment">// 无限元素集合 { 1,2,3,4}</span>
<span class="token keyword">type</span> <span class="token class-name">threeInt</span> <span class="token operator">=</span> <span class="token number">3</span> <span class="token operator">|</span> <span class="token number">6</span> <span class="token operator">|</span> <span class="token number">9</span> <span class="token comment">// 无限集合</span>
<span class="token keyword">type</span> <span class="token class-name">twoIntersectThreeInt</span> <span class="token operator">=</span> twoInt <span class="token operator">&amp;</span> threeInt <span class="token comment">// 无限集合的交集</span>
<span class="token keyword">type</span> <span class="token class-name">twoUnionThreeInt</span> <span class="token operator">=</span> <span class="token number">2</span><span class="token operator">|</span> <span class="token number">3</span> <span class="token operator">|</span> <span class="token number">4</span> <span class="token operator">|</span> <span class="token number">6</span> <span class="token operator">...</span> <span class="token comment">// 无限集合的并集</span>
<span class="token keyword">keyof</span> <span class="token punctuation">(</span><span class="token constant">A</span><span class="token operator">&amp;</span><span class="token constant">B</span><span class="token punctuation">)</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token keyword">keyof</span> <span class="token constant">A</span><span class="token punctuation">)</span> <span class="token operator">|</span> <span class="token punctuation">(</span><span class="token keyword">keyof</span> <span class="token constant">B</span><span class="token punctuation">)</span>
<span class="token keyword">keyof</span> <span class="token punctuation">(</span><span class="token constant">A</span><span class="token operator">|</span><span class="token constant">B</span><span class="token punctuation">)</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token keyword">keyof</span> <span class="token constant">A</span><span class="token punctuation">)</span> <span class="token operator">&amp;</span> <span class="token punctuation">(</span><span class="token keyword">keyof</span> <span class="token constant">B</span><span class="token punctuation">)</span>
</code></pre></div><table><thead><tr><th style="text-align:center;">Typescript术语</th> <th style="text-align:center;">集合术语</th></tr></thead> <tbody><tr><td style="text-align:center;">never</td> <td style="text-align:center;">空集</td></tr> <tr><td style="text-align:center;">literal type</td> <td style="text-align:center;">单值集合</td></tr> <tr><td style="text-align:center;">value 可赋值给 T</td> <td style="text-align:center;">value ∈ T</td></tr> <tr><td style="text-align:center;">T1 assignable to T2</td> <td style="text-align:center;">T1是T2的子集</td></tr> <tr><td style="text-align:center;">T1 extends T2</td> <td style="text-align:center;">T1是T2的子集</td></tr> <tr><td style="text-align:center;">T1丨T2</td> <td style="text-align:center;">T1和T2的并集</td></tr> <tr><td style="text-align:center;">T1 &amp; T2</td> <td style="text-align:center;">T1 和T2的交集</td></tr> <tr><td style="text-align:center;">unknown</td> <td style="text-align:center;">universal set</td></tr></tbody></table> <h3 id="_8-know-how-to-tell-whether-a-symbol-is-in-the-type-space-or-value-space"><a href="#_8-know-how-to-tell-whether-a-symbol-is-in-the-type-space-or-value-space" class="header-anchor">#</a> 8. Know How to Tell Whether a Symbol Is in the Type Space or Value Space</h3> <p>TS中一个符号可以属于Type Space或者Value Space，也可以同时处于Type Space和Value Space</p> <p>class和enum同时存在于Value Space和Type Space。对于class，既可以作为类型，也可以作为构造函数。enum本身就代表了类型，其编译后对应枚举对象(不用const修饰的情况下)</p> <p>typeof总是对值进行操作，但是在Type Space返回类型，在Value Space返回js的类型。</p> <h3 id="_9-prefer-type-declarations-to-type-assertions"><a href="#_9-prefer-type-declarations-to-type-assertions" class="header-anchor">#</a> 9. Prefer Type Declarations to Type Assertions</h3> <h3 id="_10-avoid-object-wrapper-types-string-number-boolean-symbol-bigint"><a href="#_10-avoid-object-wrapper-types-string-number-boolean-symbol-bigint" class="header-anchor">#</a> 10. Avoid Object Wrapper Types(String,Number,Boolean,Symbol,BigInt)</h3> <h3 id="_11-recognize-the-limits-of-excess-property-checking"><a href="#_11-recognize-the-limits-of-excess-property-checking" class="header-anchor">#</a> 11. Recognize the Limits of Excess Property Checking</h3> <p>When you assign an object literal to a variable or pass it as an argument to a function,it undergoes excess property checking.</p> <p>TS会根据这个对象字面量生成一个新鲜对象字面量类型(Fresh Object Literal Type),与变量类型进行比较。</p> <p>因为是新鲜对象字面量类型，所以可以通过一个中间变量绕过去</p> <div class="language-typescript extra-class"><pre class="language-typescript"><code><span class="token keyword">interface</span> <span class="token class-name">Point</span> <span class="token punctuation">{</span>
  x<span class="token operator">:</span> <span class="token builtin">number</span><span class="token punctuation">;</span>
  y<span class="token operator">:</span> <span class="token builtin">number</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span class="token comment">// 中间变量</span>
<span class="token keyword">const</span> tmp <span class="token operator">=</span> <span class="token punctuation">{</span>
  x<span class="token operator">:</span><span class="token number">1</span><span class="token punctuation">,</span>
  y<span class="token operator">:</span><span class="token number">2</span><span class="token punctuation">,</span>
  z<span class="token operator">:</span><span class="token number">3</span> 
<span class="token punctuation">}</span>
<span class="token keyword">const</span> point<span class="token operator">:</span>Point<span class="token operator">=</span> tmp<span class="token punctuation">;</span> <span class="token comment">// 不报错</span>
</code></pre></div><h3 id="_12-apply-types-to-entire-function-expressions-when-possible"><a href="#_12-apply-types-to-entire-function-expressions-when-possible" class="header-anchor">#</a> 12. Apply Types to Entire Function Expressions When Possible</h3> <p>一个典型例子是React开发函数式组件，官方提供React.FC类型，开发时写函数表达式。</p> <h3 id="_13-know-the-differences-between-type-and-interface"><a href="#_13-know-the-differences-between-type-and-interface" class="header-anchor">#</a> 13. Know the Differences Between type and interface</h3> <p>inteface无法应用于union type | intersection type | mapped type | conditional type | tuple</p> <div class="language-typescript extra-class"><pre class="language-typescript"><code><span class="token keyword">type</span> <span class="token class-name">AorB</span> <span class="token operator">=</span> <span class="token string">'A'</span> <span class="token operator">|</span> <span class="token string">'B'</span>
<span class="token keyword">type</span> <span class="token class-name">NamedVariable</span> <span class="token operator">=</span> <span class="token punctuation">(</span>Input <span class="token operator">|</span> Output<span class="token punctuation">)</span> <span class="token operator">&amp;</span> <span class="token punctuation">{</span> name<span class="token operator">:</span> <span class="token builtin">string</span><span class="token punctuation">}</span>
<span class="token keyword">type</span> <span class="token class-name"><span class="token constant">IS</span><span class="token operator">&lt;</span><span class="token constant">T</span><span class="token punctuation">,</span><span class="token constant">U</span><span class="token operator">&gt;</span></span> <span class="token operator">=</span> <span class="token constant">T</span> <span class="token keyword">extends</span> <span class="token class-name"><span class="token constant">U</span></span><span class="token operator">?</span><span class="token boolean">true</span><span class="token operator">:</span><span class="token boolean">false</span>
<span class="token keyword">type</span> <span class="token class-name">Pair</span> <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token builtin">number</span><span class="token punctuation">,</span><span class="token builtin">number</span><span class="token punctuation">]</span>
</code></pre></div><p>interface 可以augumented(合并),而type不可以</p> <h3 id="_14-use-type-operations-and-generics-to-avoid-repeating-yourself"><a href="#_14-use-type-operations-and-generics-to-avoid-repeating-yourself" class="header-anchor">#</a> 14. Use Type Operations and Generics to Avoid Repeating Yourself</h3> <p>DRY原则的类型版本。通过extends/intersection type/union type/ keyof / typeof / mapped type / generic type 等操作减少重复</p> <h3 id="_15-use-index-signatures-for-dynamic-data"><a href="#_15-use-index-signatures-for-dynamic-data" class="header-anchor">#</a> 15. Use Index Signatures for Dynamic Data</h3> <p>一般无法提前约定，只能在runtime获取的属性，采用索引签名进行建模。其他情况能用更精准类型就用更精准类型。</p> <h3 id="_16-prefer-arrays-tuples-and-arraylike-to-number-index-signatures"><a href="#_16-prefer-arrays-tuples-and-arraylike-to-number-index-signatures" class="header-anchor">#</a> 16. Prefer Arrays, Tuples, and ArrayLike to number Index Signatures</h3> <p>数组实际上是对象，其keys也是string而非number，Typescript里使用number index signature是为了进行更多的类型检查 即使如下代码x[0]和x[‘0’]的行为在运行时完全一致，但是只有x[0]才能正确的推导出类型。</p> <div class="language-typescript extra-class"><pre class="language-typescript"><code><span class="token keyword">let</span> a <span class="token operator">:</span> <span class="token builtin">string</span><span class="token punctuation">[</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span>
<span class="token keyword">let</span> x <span class="token operator">=</span> a<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span> <span class="token comment">// x类型为string</span>
<span class="token keyword">let</span> y <span class="token operator">=</span> a<span class="token punctuation">[</span><span class="token string">'0'</span><span class="token punctuation">]</span> <span class="token comment">// 但是y类型为any</span>
</code></pre></div><p>一般也很少用number index signatures，用Array或者Tuple</p> <h3 id="_17-use-readonly-to-avoid-errors-associated-with-mutation"><a href="#_17-use-readonly-to-avoid-errors-associated-with-mutation" class="header-anchor">#</a> 17. Use readonly to Avoid Errors Associated with Mutation</h3> <ul><li>If your function does not modify its parameters then declare them readonly.This makes its contract clearer and prevents inadvertent mutations in its implementation.</li> <li>Use readonly to prevent errors with mutation and to find the places in your code where mutations occur.</li></ul> <h3 id="_18-use-mapped-types-to-keep-values-in-sync"><a href="#_18-use-mapped-types-to-keep-values-in-sync" class="header-anchor">#</a> 18. Use Mapped Types to keep Values in Sync</h3> <ul><li>Use mapped types to keep related values and types synchronized.</li> <li>Consider using mapped types to force choices when adding new properties to an interface.</li></ul> <h2 id="type-inference"><a href="#type-inference" class="header-anchor">#</a> Type Inference</h2> <h3 id="_19-avoid-cluttering-your-code-with-inferable-types"><a href="#_19-avoid-cluttering-your-code-with-inferable-types" class="header-anchor">#</a> 19. Avoid Cluttering Your Code with Inferable Types</h3> <p>避免对简单的可推导类型进行标注，TypeScript可以自动推导,而且后期改动的时候要改的地方也少。</p> <p>常见的需要手动标注类型的场景：</p> <ul><li>函数参数和返回值类型。(ts规则 noImplicitAny 参数需要标注，不能有隐式any； eslint规则 explicit-function-return-type 函数需要标明返回值类型 )</li> <li>对象字面量(抽出interface利于复用，还可以辅助检查拼写错误(新鲜对象字面量类型) )，空数组(默认是 any[])</li></ul> <h3 id="_20-use-different-variables-for-different-types"><a href="#_20-use-different-variables-for-different-types" class="header-anchor">#</a> 20. Use Different Variables for Different Types</h3> <p>在JavaScript中可以把不同类型的值赋给同一个变量，这是一个非常坏的习惯。</p> <ul><li>变量值改变，类型尽可能不变。</li> <li>不同类型的值应该赋给不同的变量。</li></ul> <h3 id="_21-understand-type-widening"><a href="#_21-understand-type-widening" class="header-anchor">#</a> 21. Understand Type Widening</h3> <p>当使用一个常量初始化变量但是没有声明类型时，TS需要根据初始值决定类型，决定的类型通常会比常量类型要宽。比如<code>let a = 1</code>，TS认为a的类型时number，而初始值的类型是1。</p> <p>通常限制类型断定宽化有这么几种方式：</p> <ul><li>使用const声明变量</li> <li>声明类型</li> <li>使用const断言</li></ul> <h3 id="_22-understand-type-narrowing"><a href="#_22-understand-type-narrowing" class="header-anchor">#</a> 22. Understand Type Narrowing</h3> <p>通常类型收窄是我们主动编码的结果，有以下常见方式：</p> <ul><li>条件判断if typeof in instanceof 相等判断 不相等判断</li> <li>可辨识联合类型 (通过 可辨识字段)</li> <li>自定义类型守卫 (返回类型 x is y)</li></ul> <h3 id="_23-create-objects-all-at-once"><a href="#_23-create-objects-all-at-once" class="header-anchor">#</a> 23. Create Objects All at Once</h3> <p>定义一个对象时，尽可能一次性把属性声明完，这样对于TS类型推导有利，动态加属性 TS可能会报错。</p> <p>如果需要动态加属性，推荐使用spread operator：</p> <div class="language-typescript extra-class"><pre class="language-typescript"><code><span class="token keyword">const</span> a <span class="token operator">=</span> <span class="token punctuation">{</span>a<span class="token operator">:</span><span class="token number">1</span><span class="token punctuation">}</span>
<span class="token keyword">const</span> b <span class="token operator">=</span> <span class="token punctuation">{</span>b<span class="token operator">:</span><span class="token number">2</span><span class="token punctuation">}</span>
<span class="token keyword">const</span> ab <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token operator">...</span>a<span class="token punctuation">,</span><span class="token operator">...</span>b<span class="token punctuation">}</span>
</code></pre></div><p>对于条件性添加属性，为了类型安全，可以在null或者{}上使用spread operator。</p> <div class="language-typescript extra-class"><pre class="language-typescript"><code><span class="token keyword">const</span> hasMiddle <span class="token operator">=</span> Math<span class="token punctuation">.</span><span class="token function">random</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">&gt;</span><span class="token number">0.5</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> firstLast <span class="token operator">=</span> <span class="token punctuation">{</span>first<span class="token operator">:</span><span class="token string">'First'</span><span class="token punctuation">,</span>last<span class="token operator">:</span><span class="token string">'last'</span><span class="token punctuation">}</span>
<span class="token keyword">const</span> name <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token operator">...</span>firstLast<span class="token punctuation">,</span><span class="token operator">...</span><span class="token punctuation">(</span>hasMiddle<span class="token operator">?</span><span class="token punctuation">{</span>middle<span class="token operator">:</span><span class="token string">'M'</span><span class="token punctuation">}</span><span class="token operator">:</span><span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">}</span>
</code></pre></div><p>name此时的类型为：</p> <div class="language-typescript extra-class"><pre class="language-typescript"><code><span class="token keyword">type</span> <span class="token class-name">name</span> <span class="token operator">=</span> <span class="token punctuation">{</span>
    first<span class="token operator">:</span><span class="token builtin">string</span><span class="token punctuation">;</span>
    last<span class="token operator">:</span><span class="token builtin">string</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span> <span class="token operator">|</span> <span class="token punctuation">{</span>
    first<span class="token operator">:</span><span class="token builtin">string</span><span class="token punctuation">;</span>
    last<span class="token operator">:</span><span class="token builtin">string</span><span class="token punctuation">;</span>
    middle<span class="token operator">:</span><span class="token builtin">string</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre></div><p>然而想要的是middle可选而不是联合类型</p> <div class="language-typescript extra-class"><pre class="language-typescript"><code><span class="token comment">// 处理可选类型</span>
<span class="token keyword">function</span> <span class="token generic-function"><span class="token function">addOptional</span><span class="token generic class-name"><span class="token operator">&lt;</span><span class="token constant">T</span> <span class="token keyword">extends</span> object<span class="token punctuation">,</span><span class="token constant">U</span> <span class="token keyword">extends</span> object<span class="token operator">&gt;</span></span></span><span class="token punctuation">(</span>a<span class="token operator">:</span><span class="token constant">T</span><span class="token punctuation">,</span>b<span class="token operator">:</span><span class="token constant">U</span> <span class="token operator">|</span> <span class="token keyword">null</span><span class="token punctuation">)</span><span class="token operator">:</span><span class="token constant">T</span> <span class="token operator">&amp;</span> Partial<span class="token operator">&lt;</span><span class="token constant">U</span><span class="token operator">&gt;</span><span class="token punctuation">{</span>
    <span class="token keyword">return</span> <span class="token punctuation">{</span><span class="token operator">...</span>a<span class="token punctuation">,</span><span class="token operator">...</span>b<span class="token punctuation">}</span>
<span class="token punctuation">}</span>
<span class="token keyword">const</span> name <span class="token operator">=</span> <span class="token function">addOptional</span><span class="token punctuation">(</span>firstLast<span class="token punctuation">,</span>hasMiddle<span class="token operator">?</span><span class="token punctuation">{</span>middle<span class="token operator">:</span><span class="token string">'M'</span><span class="token punctuation">}</span><span class="token operator">:</span><span class="token keyword">null</span><span class="token punctuation">)</span>
</code></pre></div><h3 id="_24-be-consistent-in-your-use-of-aliases"><a href="#_24-be-consistent-in-your-use-of-aliases" class="header-anchor">#</a> 24. Be Consistent in Your Use of Aliases</h3> <div class="language-typescript extra-class"><pre class="language-typescript"><code><span class="token keyword">interface</span> <span class="token class-name">Whatever</span> <span class="token punctuation">{</span>
    str<span class="token operator">?</span><span class="token operator">:</span><span class="token builtin">string</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token keyword">const</span> obj<span class="token operator">:</span>Whatever <span class="token operator">=</span> <span class="token punctuation">{</span>
    str<span class="token operator">:</span><span class="token string">'meow'</span>
<span class="token punctuation">}</span>
<span class="token comment">// str 是 obj.str的别名</span>
<span class="token keyword">const</span> str <span class="token operator">=</span> obj<span class="token punctuation">.</span>str<span class="token punctuation">;</span>
<span class="token keyword">if</span><span class="token punctuation">(</span>obj<span class="token punctuation">.</span>str<span class="token punctuation">)</span><span class="token punctuation">{</span>
    <span class="token comment">// obj.str 现在是string类型</span>
    <span class="token comment">// str 是 string | undefined类型</span>
    <span class="token comment">// 这就是为什么当使用别名和类型收窄时 别名要一致</span>
<span class="token punctuation">}</span>
</code></pre></div><p>在TS 4.6对控制流分析做了优化</p> <h3 id="_25-use-async-functions-instead-of-callbacks-for-asynchronous-code"><a href="#_25-use-async-functions-instead-of-callbacks-for-asynchronous-code" class="header-anchor">#</a> 25. Use async Functions Instead of Callbacks for Asynchronous Code</h3> <h3 id="_26-understand-how-context-is-used-in-type-inference"><a href="#_26-understand-how-context-is-used-in-type-inference" class="header-anchor">#</a> 26. Understand How Context Is Used in Type Inference</h3> <p>类型推断和上下文有关。一般而言，TS推断变量的类型是根据变量被引入时，而不是使用时，通常伴随着之前的Type Widening现象。</p> <h3 id="_27-use-functional-constructs-and-libraries-to-help-types-flow"><a href="#_27-use-functional-constructs-and-libraries-to-help-types-flow" class="header-anchor">#</a> 27. Use Functional Constructs and Libraries to Help Types Flow</h3> <h2 id="type-design"><a href="#type-design" class="header-anchor">#</a> Type Design</h2> <h3 id="_28-prefer-types-that-always-represent-valid-states"><a href="#_28-prefer-types-that-always-represent-valid-states" class="header-anchor">#</a> 28. Prefer Types That Always Represent Valid States</h3> <p>避免使用一个类型多个变量建模状态，用可辨识的多个类型联合建模状态。</p> <h3 id="_29-be-liberal-in-what-you-accept-and-strict-in-what-you-produce"><a href="#_29-be-liberal-in-what-you-accept-and-strict-in-what-you-produce" class="header-anchor">#</a> 29. Be Liberal in What You Accept and Strict in What You Produce</h3> <p>对入参宽松(支持多种类型参数)，对出参严格(统一格式)</p> <h3 id="_30-don-t-repeat-type-infomation-in-document"><a href="#_30-don-t-repeat-type-infomation-in-document" class="header-anchor">#</a> 30. Don't Repeat Type Infomation in Document</h3> <h3 id="_31-push-null-values-to-the-perimeter-of-your-type"><a href="#_31-push-null-values-to-the-perimeter-of-your-type" class="header-anchor">#</a> 31. Push Null Values to the Perimeter of Your Type</h3> <ul><li>Avoid designs in which one value being null or not null is implicitly related to another value being null or not null</li> <li>Push null values to the perimeter of your API by making larger objects either null or fully non-null. This will make code clearer both for human readers and for the type checker.</li> <li>Consider creating a fully non-null class and constructing it when all values are available.</li></ul> <h3 id="_32-prefer-unions-of-interfaces-to-interfaces-of-unions"><a href="#_32-prefer-unions-of-interfaces-to-interfaces-of-unions" class="header-anchor">#</a> 32. Prefer Unions of Interfaces to Interfaces of Unions</h3> <p>考虑下述类型定义</p> <div class="language-typescript extra-class"><pre class="language-typescript"><code><span class="token keyword">interface</span> <span class="token class-name">Layer</span> <span class="token punctuation">{</span>
  layout<span class="token operator">:</span> FillLayout <span class="token operator">|</span> LineLayout <span class="token operator">|</span> PointLayout<span class="token punctuation">;</span>
  paint<span class="token operator">:</span> FillPaint <span class="token operator">|</span> LinePaint <span class="token operator">|</span> PointPaint
<span class="token punctuation">}</span>
</code></pre></div><p>这样设计的类型很难关联layout和对应的paint,重构如下</p> <div class="language-typescript extra-class"><pre class="language-typescript"><code><span class="token keyword">interface</span> <span class="token class-name">FillLayer</span> <span class="token punctuation">{</span>
  type<span class="token operator">:</span> <span class="token string">'fill'</span><span class="token punctuation">,</span>
  layout<span class="token operator">:</span> FillLayout<span class="token punctuation">,</span>
  paint<span class="token operator">:</span> FillPaint
<span class="token punctuation">}</span>
<span class="token keyword">interface</span> <span class="token class-name">LineLayer</span> <span class="token punctuation">{</span>
  type<span class="token operator">:</span> <span class="token string">'line'</span><span class="token punctuation">,</span>
  layout<span class="token operator">:</span> LineLayout<span class="token punctuation">,</span>
  paint<span class="token operator">:</span> LinePaint
<span class="token punctuation">}</span>
<span class="token keyword">interface</span> <span class="token class-name">PointLayer</span> <span class="token punctuation">{</span>
  type<span class="token operator">:</span> <span class="token string">'paint'</span><span class="token punctuation">,</span>
  layout<span class="token operator">:</span> PointLayout<span class="token punctuation">,</span>
  paint<span class="token operator">:</span> PointPaint
<span class="token punctuation">}</span>

<span class="token keyword">type</span> <span class="token class-name">Layer</span> <span class="token operator">=</span> FillLayer <span class="token operator">|</span> LineLayer <span class="token operator">|</span>PointLayer
</code></pre></div><p>和28类似，都是使用可辨识联合类型，处理有关联的多个字段。</p> <h3 id="_33-prefer-more-precise-alternatives-to-string-types"><a href="#_33-prefer-more-precise-alternatives-to-string-types" class="header-anchor">#</a> 33. Prefer More Precise Alternatives to String Types</h3> <h3 id="_34-prefer-incomplete-types-to-inaccurate-types"><a href="#_34-prefer-incomplete-types-to-inaccurate-types" class="header-anchor">#</a> 34. Prefer Incomplete Types to Inaccurate Types</h3> <h3 id="_35-generate-types-from-apis-and-specs-not-data"><a href="#_35-generate-types-from-apis-and-specs-not-data" class="header-anchor">#</a> 35. Generate Types from APIs and Specs, Not Data</h3> <h3 id="_36-name-types-using-the-language-of-your-problem-domain"><a href="#_36-name-types-using-the-language-of-your-problem-domain" class="header-anchor">#</a> 36. Name Types Using the Language of Your Problem Domain</h3> <h3 id="_37-consider-brands-for-norminal-typing"><a href="#_37-consider-brands-for-norminal-typing" class="header-anchor">#</a> 37. Consider &quot;Brands&quot; for Norminal Typing</h3> <p>TS时结构化类型而不是名义类型，模拟名义类型可以参考<a href="https://react-typescript-cheatsheet.netlify.app/docs/basic/troubleshooting/types/#simulating-nominal-types" target="_blank" rel="noopener noreferrer">Simulating Nominal Types<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></p> <div class="language-typescript extra-class"><pre class="language-typescript"><code><span class="token keyword">type</span> <span class="token class-name">OrderID</span> <span class="token operator">=</span> <span class="token builtin">string</span> <span class="token operator">&amp;</span> <span class="token punctuation">{</span> <span class="token keyword">readonly</span> brand<span class="token operator">:</span> unique <span class="token builtin">symbol</span> <span class="token punctuation">}</span><span class="token punctuation">;</span>
<span class="token keyword">type</span> <span class="token class-name">UserID</span> <span class="token operator">=</span> <span class="token builtin">string</span> <span class="token operator">&amp;</span> <span class="token punctuation">{</span> <span class="token keyword">readonly</span> brand<span class="token operator">:</span> unique <span class="token builtin">symbol</span> <span class="token punctuation">}</span><span class="token punctuation">;</span>
<span class="token keyword">type</span> <span class="token class-name"><span class="token constant">ID</span></span> <span class="token operator">=</span> OrderID <span class="token operator">|</span> UserID<span class="token punctuation">;</span>

<span class="token keyword">function</span> <span class="token function">OrderID</span><span class="token punctuation">(</span>id<span class="token operator">:</span> <span class="token builtin">string</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">return</span> id <span class="token keyword">as</span> OrderID<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span class="token keyword">function</span> <span class="token function">UserID</span><span class="token punctuation">(</span>id<span class="token operator">:</span> <span class="token builtin">string</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">return</span> id <span class="token keyword">as</span> UserID<span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token keyword">function</span> <span class="token function">queryForUser</span><span class="token punctuation">(</span>id<span class="token operator">:</span> UserID<span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token comment">// ...</span>
<span class="token punctuation">}</span>
<span class="token function">queryForUser</span><span class="token punctuation">(</span><span class="token function">OrderID</span><span class="token punctuation">(</span><span class="token string">&quot;foobar&quot;</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// Error, Argument of type 'OrderID' is not assignable to parameter of type 'UserID'</span>

</code></pre></div><h2 id="working-with-any"><a href="#working-with-any" class="header-anchor">#</a> Working with any</h2> <h3 id="_38-use-the-narrowest-possible-scope-for-any-types"><a href="#_38-use-the-narrowest-possible-scope-for-any-types" class="header-anchor">#</a> 38. Use the Narrowest Possible Scope for any Types</h3> <p>尽可能缩小any的影响范围：</p> <div class="language-typescript extra-class"><pre class="language-typescript"><code><span class="token keyword">function</span> <span class="token function">f1</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
  <span class="token keyword">const</span> x<span class="token operator">:</span> <span class="token builtin">any</span> <span class="token operator">=</span> <span class="token function">expressionReturningFoo</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// 不建议,后续的x都是any了 如果f1返回x any会影响到其他函数</span>
  <span class="token function">processBar</span><span class="token punctuation">(</span>x<span class="token punctuation">)</span>
<span class="token punctuation">}</span>

<span class="token keyword">function</span> <span class="token function">f2</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
  <span class="token keyword">const</span> x <span class="token operator">=</span> <span class="token function">expressionReturningFoo</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token function">processBar</span><span class="token punctuation">(</span>x <span class="token keyword">as</span> <span class="token builtin">any</span><span class="token punctuation">)</span> <span class="token comment">// 建议，只有这里是any 后续x依然是Foo类型</span>
<span class="token punctuation">}</span>

</code></pre></div><p>对于对象：</p> <div class="language-typescript extra-class"><pre class="language-typescript"><code><span class="token keyword">const</span> config1<span class="token operator">:</span>Config <span class="token operator">=</span> <span class="token punctuation">{</span>
  a<span class="token operator">:</span><span class="token number">1</span><span class="token punctuation">,</span>
  b<span class="token operator">:</span><span class="token number">2</span><span class="token punctuation">,</span>
  c<span class="token operator">:</span><span class="token punctuation">{</span>
    key<span class="token operator">:</span><span class="token string">'1'</span><span class="token punctuation">,</span>
    <span class="token comment">// 缺少foo属性</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span> <span class="token keyword">as</span> <span class="token builtin">any</span> <span class="token comment">// 不推荐 因为只想不处理c属性，其他的属性还要类型校验</span>

<span class="token keyword">const</span> config2<span class="token operator">:</span>Config <span class="token operator">=</span> <span class="token punctuation">{</span>
  a<span class="token operator">:</span><span class="token number">1</span><span class="token punctuation">,</span>
  b<span class="token operator">:</span><span class="token number">2</span><span class="token punctuation">,</span>
  c<span class="token operator">:</span><span class="token punctuation">{</span>
    key<span class="token operator">:</span><span class="token string">'1'</span>
  <span class="token punctuation">}</span> <span class="token keyword">as</span> <span class="token builtin">any</span> <span class="token comment">// 推荐 any范围限于c</span>
<span class="token punctuation">}</span>
</code></pre></div><h3 id="_39-prefer-more-precise-variants-of-any-to-plain-any"><a href="#_39-prefer-more-precise-variants-of-any-to-plain-any" class="header-anchor">#</a> 39. Prefer More Precise Variants of any to Plain any</h3> <p>虽说用any，也要有个下限。比如知道是数组，可是使用<code>any[]</code>；知道是对象，可以使用<code>{[x:string]:any}</code>；知道是函数，可以使用<code>(...args:any[])=&gt;any</code>。</p> <h3 id="_40-hide-unsafe-type-assertions-in-well-typed-functions"><a href="#_40-hide-unsafe-type-assertions-in-well-typed-functions" class="header-anchor">#</a> 40. Hide Unsafe Type Assertions in Well-Typed Functions</h3> <p>有时候不使用any想编写一个完全类型安全的实现并非易事，但是一般对于使用者 并不关心内部的实现是否安全，只关心对外暴露的签名是否安全，此时我们可以将函数签名和 函数实现相分离，以简化内部的类型实现。</p> <h3 id="_41-understand-evolving-any"><a href="#_41-understand-evolving-any" class="header-anchor">#</a> 41. Understand Evolving any</h3> <p>Typescript中的any并不是一成不变的，会随着用户的操作，Typescript会猜测更加合理的类型</p> <div class="language-typescript extra-class"><pre class="language-typescript"><code><span class="token keyword">function</span> <span class="token function">range</span><span class="token punctuation">(</span>start<span class="token operator">:</span><span class="token builtin">number</span><span class="token punctuation">,</span>limit<span class="token operator">:</span><span class="token builtin">number</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
  <span class="token keyword">const</span> out <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">;</span> <span class="token comment">// any[]</span>
  <span class="token keyword">for</span><span class="token punctuation">(</span><span class="token keyword">let</span> i<span class="token operator">=</span>start<span class="token punctuation">;</span>i<span class="token operator">&lt;</span>limit<span class="token punctuation">;</span>i<span class="token operator">++</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
    out<span class="token punctuation">.</span><span class="token function">push</span><span class="token punctuation">(</span>i<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
  <span class="token keyword">return</span> out<span class="token punctuation">;</span> <span class="token comment">// number[]</span>
<span class="token punctuation">}</span>


<span class="token keyword">function</span> <span class="token function">range2</span><span class="token punctuation">(</span>start<span class="token operator">:</span><span class="token builtin">number</span><span class="token punctuation">,</span>limit<span class="token operator">:</span><span class="token builtin">number</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
  <span class="token keyword">const</span> out <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span> <span class="token comment">// any[]</span>
  <span class="token keyword">if</span><span class="token punctuation">(</span>start <span class="token operator">===</span> limit<span class="token punctuation">)</span><span class="token punctuation">{</span>
    <span class="token keyword">return</span> out <span class="token comment">// any[]</span>
  <span class="token punctuation">}</span>
  <span class="token keyword">for</span><span class="token punctuation">(</span><span class="token keyword">let</span> i<span class="token operator">=</span>start<span class="token punctuation">;</span>i<span class="token operator">&lt;</span>limit<span class="token punctuation">;</span>i<span class="token operator">++</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
    out<span class="token punctuation">.</span><span class="token function">push</span><span class="token punctuation">(</span>i<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
  <span class="token keyword">return</span> out<span class="token punctuation">;</span> <span class="token comment">// number[]</span>
<span class="token punctuation">}</span>
</code></pre></div><p>然而最好还是必要的时候明确的声明</p> <h3 id="_42-use-unknown-instead-of-any-for-values-with-an-unknown-type"><a href="#_42-use-unknown-instead-of-any-for-values-with-an-unknown-type" class="header-anchor">#</a> 42. Use unknown Instead of any for Values with an Unknown Type</h3> <ul><li>The unknown type is a type-safe alternative to any. Use it when you know you have a value but do not know what its type is.</li> <li>Use unknown to force your users to use a type assertion or do type checking.</li></ul> <h3 id="_43-prefer-type-safe-approaches-to-monkey-patching"><a href="#_43-prefer-type-safe-approaches-to-monkey-patching" class="header-anchor">#</a> 43.Prefer Type-Safe Approaches to Monkey Patching</h3> <ul><li>Prefer structured code to storing data in globals or on the DOM</li> <li>If you must store data on built-in types,use one of the type-safe approaches (augmentation or asserting a custom interface)</li></ul> <h3 id="_44-track-your-type-coverage-to-prevent-regressions-in-type-safety"><a href="#_44-track-your-type-coverage-to-prevent-regressions-in-type-safety" class="header-anchor">#</a> 44. Track Your Type Coverage to Prevent Regressions in Type Safety</h3> <h2 id="types-declarations-and-types"><a href="#types-declarations-and-types" class="header-anchor">#</a> Types Declarations and @types</h2> <h3 id="_45-put-typescript-and-types-in-devdependencies"><a href="#_45-put-typescript-and-types-in-devdependencies" class="header-anchor">#</a> 45. Put TypeScript and @types in devDependencies</h3> <h3 id="_46-understand-the-three-versions-involved-in-type-declarations"><a href="#_46-understand-the-three-versions-involved-in-type-declarations" class="header-anchor">#</a> 46. Understand the Three Versions Involved in Type Declarations</h3> <p>一个库的类型声明和三个库的版本有关：库本身版本，@types版本，TypeScript版本，这三个版本不匹配可能会导致一些问题。</p> <p>用TS开发，库本身就导出类型，可以减少一个变量。</p> <h3 id="_47-export-all-types-that-appear-in-public-apis"><a href="#_47-export-all-types-that-appear-in-public-apis" class="header-anchor">#</a> 47. Export All Types That Appear in Public APIs</h3> <p>将公用API里使用的类型也一并导出，方便其他人使用。即使不导出，其他用户也可以使用ReturnType Parameters获取。</p> <h3 id="_48-use-tsdoc-for-api-comments"><a href="#_48-use-tsdoc-for-api-comments" class="header-anchor">#</a> 48. Use TSDoc for API Comments</h3> <h3 id="_49-provide-a-type-for-this-in-callbacks"><a href="#_49-provide-a-type-for-this-in-callbacks" class="header-anchor">#</a> 49. Provide a Type for this in Callbacks</h3> <h3 id="_50-prefer-conditional-types-to-overloaded-declarations"><a href="#_50-prefer-conditional-types-to-overloaded-declarations" class="header-anchor">#</a> 50. Prefer Conditional Types to Overloaded Declarations</h3> <p>下面的例子，用条件类型比用函数重载更简介(我也不喜欢用函数重载)</p> <div class="language-typescript extra-class"><pre class="language-typescript"><code><span class="token keyword">function</span> <span class="token generic-function"><span class="token function">double</span><span class="token generic class-name"><span class="token operator">&lt;</span><span class="token constant">T</span> <span class="token keyword">extends</span> <span class="token builtin">string</span> <span class="token operator">|</span> <span class="token builtin">number</span><span class="token operator">&gt;</span></span></span><span class="token punctuation">(</span>val<span class="token operator">:</span><span class="token constant">T</span><span class="token punctuation">)</span><span class="token operator">:</span><span class="token constant">T</span> <span class="token keyword">extends</span> <span class="token class-name"><span class="token builtin">string</span></span><span class="token operator">?</span><span class="token builtin">string</span><span class="token operator">:</span><span class="token builtin">number</span><span class="token punctuation">{</span>
  <span class="token keyword">return</span> val<span class="token operator">+</span>val<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre></div><h3 id="_51-mirror-types-to-server-dependencies"><a href="#_51-mirror-types-to-server-dependencies" class="header-anchor">#</a> 51. Mirror Types to Server Dependencies</h3> <p>尽量避免用户对@types的依赖，不要强制web用户依赖NodeJS的types</p> <h3 id="_52-be-aware-of-the-pitfalls-of-testing-types"><a href="#_52-be-aware-of-the-pitfalls-of-testing-types" class="header-anchor">#</a> 52. Be Aware of the Pitfalls of Testing Types</h3> <p>然而一般写业务也不用测试类型啊🤔</p> <h2 id="writing-and-running-your-code"><a href="#writing-and-running-your-code" class="header-anchor">#</a> Writing and Running Your Code</h2> <h3 id="_53-prefer-ecmascript-features-to-typescript-features"><a href="#_53-prefer-ecmascript-features-to-typescript-features" class="header-anchor">#</a> 53. Prefer ECMAScript Features to TypeScript Features</h3> <p>优先考虑使用ES特性而不是TS独有特性，把TS定位在Type层面</p> <ul><li>Enums 实际上枚举用的不多，一般是用字面量的联合类型替代</li> <li>Parameter Properties 给类constructor的参数提供修饰符 这些参数会自动挂载到同名属性上。这个feature其实有点鸡肋，而且现在class语法本身用的就不多了</li> <li>Namespace and Triple-Slash Imports 这两个是ES没提出模块方案前的替代品，没有使用意义了</li> <li>Decorators 装饰器的最大问题其实是他还不稳定</li></ul> <h3 id="_54-know-how-to-iterate-over-objects"><a href="#_54-know-how-to-iterate-over-objects" class="header-anchor">#</a> 54. Know How to Iterate Over Objects</h3> <p>使用for k in obj语法遍历对象，k的类型被放宽到string，这是因为TS是结构化类型，对于某个可赋值给某个类型的变量，可能会有额外属性，所以k要放宽。</p> <p>Object.entries 是一个可行的替代，然而类型还是有问题。。。</p> <h3 id="_55-understand-the-dom-hierarchy"><a href="#_55-understand-the-dom-hierarchy" class="header-anchor">#</a> 55. Understand the DOM hierarchy</h3> <p>Know the dofferences between Node,Element,HTMLElement,and EventTarget as well as those between Event and MouseEvent.</p> <p>Either use a specific enough type for DOM elements and Events in your code or give TypeScript the context to infer it.</p> <h3 id="_56-dont-t-rely-on-private-to-hide-infomation"><a href="#_56-dont-t-rely-on-private-to-hide-infomation" class="header-anchor">#</a> 56. Dont`t Rely on Private to Hide Infomation</h3> <p>TS class的private protected 修饰符本身只是类型层面的，不存在于运行时，显然标记为私有的字段依然可以在运行时从外部访问。</p> <p>private field是ES提出的私有字段解决方案(然而#语法好丑)</p> <h3 id="_57-use-source-maps-to-debug-typescript"><a href="#_57-use-source-maps-to-debug-typescript" class="header-anchor">#</a> 57. Use Source Maps to Debug TypeScript</h3> <h2 id="migrating-to-typescript"><a href="#migrating-to-typescript" class="header-anchor">#</a> Migrating to TypeScript</h2> <h3 id="_58-write-modern-javascript"><a href="#_58-write-modern-javascript" class="header-anchor">#</a> 58. Write Modern JavaScript</h3> <h3 id="_59-use-ts-check-and-jsdoc-to-experiment-with-typescript"><a href="#_59-use-ts-check-and-jsdoc-to-experiment-with-typescript" class="header-anchor">#</a> 59. Use @ts-check and JSDoc to Experiment with TypeScript</h3> <h3 id="_60-use-allowjs-to-mix-typescript-and-javascript"><a href="#_60-use-allowjs-to-mix-typescript-and-javascript" class="header-anchor">#</a> 60. Use allowJs to Mix TypeScript and JavaScript</h3> <h3 id="_61-convert-module-by-module-up-your-depency-graph"><a href="#_61-convert-module-by-module-up-your-depency-graph" class="header-anchor">#</a> 61. Convert Module By Module Up Your Depency Graph</h3> <h3 id="_62-dont-t-consider-migration-complete-until-you-enable-noimplicitany"><a href="#_62-dont-t-consider-migration-complete-until-you-enable-noimplicitany" class="header-anchor">#</a> 62. Dont`t Consider Migration Complete Until You Enable noImplicitAny</h3></div> <footer class="page-edit"><!----> <!----></footer> <div class="page-nav"><p class="inner"><span class="prev">
      ←
      <a href="/notebook/web-security/" class="prev">
        白帽子讲Web安全
      </a></span> <span class="next"><a href="/notebook/nodejs-in-practice/">
        Node.js硬实战：115个核心技巧
      </a>
      →
    </span></p></div> </main></div><div class="global-ui"></div></div>
    <script src="/notebook/assets/js/app.88dbcdf2.js" defer></script><script src="/notebook/assets/js/2.afe3d9dc.js" defer></script><script src="/notebook/assets/js/46.b3c5cf46.js" defer></script>
  </body>
</html>
